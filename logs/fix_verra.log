Traceback (most recent call last):
  File "/home/sangumang/Documents/sisinfops/run_fix_verra.py", line 154, in run_fix
    cursor.execute("SELECT status FROM verra_project_registrations LIMIT 3")
psycopg2.errors.UndefinedColumn: column "status" does not exist
LINE 1: SELECT status FROM verra_project_registrations LIMIT 3
               ^

ğŸš€ VERRA COLUMN FIX SCRIPT

This script will fix the column mismatch in verra_project_registrations table.
Frontend error: 'Error fetching carbon projects: {}'
Cause: Frontend expects 'status' column but table has 'registration_status'
============================================================
============================================================
ğŸ”§ FIXING VERRA TABLE COLUMNS
============================================================

Problem: Frontend expects 'status' column but table has 'registration_status'
Solution: Add 'status' column and copy data from 'registration_status'
============================================================
âœ… Connected to db.saelrsljpneclsbfdxfy.supabase.co
ğŸ“„ Reading fix SQL: fix_verra_column.sql
   ğŸ’¬ -- FIX VERRA_PROJECT_REGISTRATIONS TABLE COLUMNS
   ğŸ’¬ -- Frontend expects column 'status' but we have 'registration_status'
   ğŸ’¬ -- Also ensure all required columns exist
   ğŸ’¬ -- 1. Add status column if it doesn't exist (for frontend compatibility)
   ğŸ’¬ -- 2. Copy data from registration_status to status
   ğŸ’¬ -- 3. Also ensure carbon_project_id exists for frontend
   ğŸ’¬ -- Copy from project_id
   ğŸ’¬ -- 4. Add sample data for testing
   ğŸ’¬ -- Get a carbon project ID
   ğŸ’¬ -- Ensure we have at least one verra registration with status
   ğŸ’¬ -- Update existing records to have status
   ğŸ’¬ -- 5. Verify the fix
   ğŸ’¬ -- Check if columns exist
   Found 34 SQL statements
   âœ… Statement 1 executed
   âŒ Statement 2 failed: unterminated dollar-quoted string at or near "$$ 
   âŒ Statement 3 failed: syntax error at or near "IF"
   âŒ Statement 4 failed: unterminated dollar-quoted string at or near "$$;"
   âŒ Statement 5 failed: column "status" does not exist
   âŒ Statement 6 failed: unterminated dollar-quoted string at or near "$$ 
   âœ… Statement 7 executed
   âŒ Statement 8 failed: syntax error at or near "IF"
   âŒ Statement 9 failed: unterminated dollar-quoted string at or near "$$;"
   âŒ Statement 10 failed: unterminated dollar-quoted string at or near "$$
   âŒ Statement 11 failed: syntax error at or near "SELECT"
   âŒ Statement 12 failed: syntax error at or near "IF"
   âŒ Statement 13 failed: column "status" does not exist
   âŒ Statement 14 failed: syntax error at or near "IF"
   âŒ Statement 15 failed: unterminated dollar-quoted string at or near "$$;"
   âŒ Statement 16 failed: unterminated dollar-quoted string at or near "$$
   âŒ Statement 17 failed: syntax error at or near "has_carbon_project_id_column"
   âŒ Statement 18 failed: syntax error at or near "verra_count"
   âŒ Statement 19 failed: syntax error at or near "SELECT"
   âœ… Statement 20 executed
   âœ… Statement 21 executed
   âŒ Statement 22 failed: syntax error at or near "RAISE"
   âŒ Statement 23 failed: syntax error at or near "RAISE"
   âŒ Statement 24 failed: syntax error at or near "RAISE"
   âŒ Statement 25 failed: syntax error at or near "RAISE"
   âŒ Statement 26 failed: syntax error at or near "RAISE"
   âŒ Statement 27 failed: syntax error at or near "RAISE"
   âŒ Statement 28 failed: syntax error at or near "RAISE"
   âŒ Statement 29 failed: syntax error at or near "RAISE"
   âŒ Statement 30 failed: syntax error at or near "RAISE"
   âŒ Statement 31 failed: syntax error at or near "RAISE"
   âŒ Statement 32 failed: unterminated dollar-quoted string at or near "$$;"
   âœ… Statement 33 executed
   âœ… Statement 34 executed

ğŸ“Š Results: 6 successful, 28 failed

ğŸ” Verifying fix...
âœ… Columns in verra_project_registrations:
   â€¢ carbon_project_id (uuid)
   â€¢ registration_status (character varying)
âœ… Total records: 1
âŒ Error during fix: column "status" does not exist
LINE 1: SELECT status FROM verra_project_registrations LIMIT 3
               ^

ğŸ”Œ Database connection closed

âŒ Fix failed to apply completely

ğŸ“‹ NEXT STEPS:
1. Restart Next.js dev server
2. Clear browser cache
3. Test http://localhost:3001/dashboard/verra-registration
4. Check browser console for any remaining errors
